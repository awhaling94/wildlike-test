<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Climb! Retro - Wildlike</title>
  <link rel="stylesheet" href="../assets/css/style.css"/>
  <style>
    /* === Navigation Bar === */
    .main-nav {
      display: flex;
      justify-content: center;
      background-color: #fff;
      padding: 1em 0;
      border-bottom: 1px solid #ccc;
    }

    .main-nav ul {
      list-style: none;
      display: flex;
      gap: 2em;
      margin: 0;
      padding: 0;
    }

    .main-nav a {
      text-decoration: none;
      color: black;
      font-weight: 600;
      padding: 0.5em 1em;
    }

    /* === Top White Banner with Logo === */
    .top-banner {
      background-color: #fff;
      padding: 5em 0 1em;
      text-align: center;
      border-bottom: 1px solid #eee;
    }

    .top-banner img.logo {
      height: auto;
      width: auto;
      max-height: 90px;
      max-width: 80%; /* or whatever makes sense for your layout */
      object-fit: contain;
    }

    .top-banner a {
      display: inline-block;
    }

    .product-page {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 2em;
      max-width: 1200px;
      margin: 0 auto;
      gap: 2em;
    }

    .product-images {
    flex: 1 1 400px;
    position: relative;
    height: 400px; /* Set consistent height */
    overflow: hidden;
    }

    .product-images img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 400px;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.8s ease-in-out;
    z-index: 0;
    }

    .product-images img.active {
    opacity: 1;
    z-index: 1;
    }

    .image-nav {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    display: flex;
    justify-content: space-between;
    transform: translateY(-50%);
    z-index: 2;
    padding: 0 0.5em;
    pointer-events: none; /* allows clicks to pass through where no button exists */
    }

    .image-nav button {
    background: rgba(0, 0, 0, 0.6);
    border: none;
    color: #fff;
    padding: 0.5em 1em;
    cursor: pointer;
    pointer-events: auto; /* re-enable click on buttons */
    border-radius: 4px;
    font-size: 1.2em;
    }

    .product-details p {
      line-height: 1.2;
      font-size: 1em;
      margin-bottom: 1em; /* Adds space between paragraphs */
    }

    .product-details {
      flex: 1 1 300px;
    }

    .product-details h1 {
      margin-top: 0;
      font-size: 2em;
      font-weight: bold;
    }

    .product-details .price {
      font-weight: bold;
      font-size: 1.25em;
      margin: 0.5em 0 1em;
    }

    .product-details button {
      background-color: black;
      color: white;
      border: none;
      padding: 0.75em 1.5em;
      font-size: 1em;
      border-radius: 5px;
      cursor: pointer;
    }

    .shop-banner {
      padding: 1em 0;
      text-align: center;
      margin-top: 3em;
    }

    .shop-banner img {
      max-width: 100%;
      height: 120px;
      object-fit: cover;
    }

    .shop-button {
      display: inline-block;
      margin-top: 1em;
      background: black;
      color: white;
      padding: 0.75em 2em;
      text-decoration: none;
      border-radius: 5px;
      font-weight: bold;
    }
    
    /* === Fullscreen Image Modal === */
    .fullscreen-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      backdrop-filter: blur(6px);
      background-color: rgba(0, 0, 0, 0.8);
      justify-content: center;
      align-items: center;
    }

    .fullscreen-modal img {
      max-width: 90%;
      max-height: 90%;
      object-fit: contain;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
    }

    .fullscreen-modal .close-btn {
      position: absolute;
      top: 1rem;
      right: 1.5rem;
      font-size: 2rem;
      color: white;
      cursor: pointer;
      z-index: 1001;
    }

  </style>
</head>
<body>

  <!-- === Navigation Tabs === -->
  <nav class="main-nav">
    <ul>
      <li><a href="../shop/">Shop</a></li>
      <li><a href="../cart/">Cart</a></li>
      <li><a href="#">Blog</a></li>
      <li><a href="https://www.instagram.com/wildlike.shop" target="_blank">Insta</a></li>
    </ul>
  </nav>

  <!-- === White Banner with Logo === -->
  <div class="top-banner">
    <a href="../">
      <img src="../assets/img/logo.png" alt="Wildlike Logo" class="logo" />
    </a>
  </div>

  <!-- === Product Page Layout === -->
  <section class="product-page">
    <!-- Rotating Image Section -->
    <div class="product-images">
    <img src="../assets/img/products/climbretro_1.jpg" alt="Front" class="active">
    <img src="../assets/img/products/climbretro_2.png" alt="Back">
    <img src="../assets/img/products/climbretro_3.jpg" alt="Detail">
    <img src="../assets/img/products/climbretro_4.png" alt="Action">
    <img src="../assets/img/products/climbretro_5.jpg" alt="Action">
    <div class="image-nav">
        <button onclick="prevImage()">&#8592; Prev</button>
        <button onclick="nextImage()">Next &#8594;</button>
    </div>
    </div>


    <!-- Product Description & Button -->
  <div class="product-details">
    <h1>Climb! Retro comic book 3/4 sleeve</h1>
    <p class="price">$45.00</p>
    <p>
      Every adventure tells a story—wear this retro comic book-inspired shirt on your next climb or around town, and let it spark epic tales among you and your friends. Whether scaling new heights or just hanging out, this bold design brings the thrill of the climb to life, making it the perfect piece for any occasion. 
    </p>
    <p><strong>Fabric:</strong>100% polyester</p>
    <p><strong>Activity:</strong>Wicks sweat, dries fast, and moves with you—perfect for long sessions and full range of motion. 3/4 sleeves offer coverage without getting in the way.</p>
    <p><strong>Sizing:</strong>Unisex fit. Sizing tip: Men’s sizing is generally true to size, women are advised to size one down. Evan is 6’2” and wearing a size X-Large.</p>
    <p><strong>Color:</strong>White and black color block</p>

    <form id="productForm" onsubmit="handleAddToCart(event)" style="display: flex; flex-direction: column; gap: 1em; max-width: 250px;">
      <label for="size">Size:</label>
      <select id="size" name="size" required>
        <option value="">Loading sizes...</option>
      </select>

      <label for="quantity">Quantity:</label>
      <select id="quantity" name="quantity" required disabled>
        <option value="">Select size first</option>
      </select>

      <button type="submit">Add to Cart</button>
    </form>

  </div>

  </section>

  <!-- === Bottom Banner === -->
  <section class="shop-banner">
    <img src="../assets/img/banner.jpg" alt="Shop Banner">
    <a href="../shop/" class="shop-button">Shop</a>
  </section>

  <!-- === Fullscreen Image Modal === -->
  <div id="fullscreenModal" class="fullscreen-modal">
    <span class="close-btn">&times;</span>
    <img id="fullscreenImage" src="" alt="Fullscreen View" />
  </div>

  <!-- === Scripts === -->
  <script src="../scripts/cart.js"></script>

  <!-- Rotating Image Logic -->
  <script>
    const images = document.querySelectorAll('.product-images img');
    let currentImage = 0;

    function showImage(index) {
      images.forEach(img => img.classList.remove('active'));
      images[index].classList.add('active');
    }

    function prevImage() {
      currentImage = (currentImage - 1 + images.length) % images.length;
      showImage(currentImage);
    }

    function nextImage() {
      currentImage = (currentImage + 1) % images.length;
      showImage(currentImage);
    }
  </script>

  <!-- Product Inventory, Size, Quantity, Add to Cart -->
  <script>
    const productAlias = "climb-retro";
    const sizeSelect = document.getElementById("size");
    const quantitySelect = document.getElementById("quantity");

    let inventory = {};
    let availableSizes = {};

    fetch("../data/inventory.json")
      .then(response => response.json())
      .then(data => {
        inventory = data;
        availableSizes = { ...inventory[productAlias] };
        updateSizeOptions();
      })
      .catch(error => {
        sizeSelect.innerHTML = '<option value="">Error loading sizes</option>';
        console.error("Error loading inventory:", error);
      });

    function updateSizeOptions() {
      sizeSelect.innerHTML = '<option value="">Select Size</option>';
      Object.entries(availableSizes).forEach(([size, qty]) => {
        const option = document.createElement("option");
        option.value = size;
        option.textContent = qty > 0 ? `${size} (${qty} left)` : `${size} (Sold Out)`;
        option.disabled = qty === 0;
        sizeSelect.appendChild(option);
      });
    }

    sizeSelect.addEventListener("change", () => {
      const selectedSize = sizeSelect.value;
      const maxQty = availableSizes[selectedSize] || 0;

      quantitySelect.innerHTML = "";
      if (!selectedSize || maxQty === 0) {
        quantitySelect.disabled = true;
        quantitySelect.innerHTML = '<option value="">Select size first</option>';
        return;
      }

      quantitySelect.disabled = false;
      for (let i = 1; i <= maxQty; i++) {
        const opt = document.createElement("option");
        opt.value = i;
        opt.textContent = i;
        quantitySelect.appendChild(opt);
      }
    });

    function handleAddToCart(event) {
      event.preventDefault();

      const size = sizeSelect.value;
      const quantity = parseInt(quantitySelect.value, 10);

      if (!size || !quantity || quantity === 0) {
        alert("Please select both size and quantity.");
        return;
      }

      const name = "Climb! Retro comic book 3/4 sleeve";
      const price = 40.00;

      addToCart(name, price, size, quantity);

      // Decrement available inventory in current session
      availableSizes[size] -= quantity;
      updateSizeOptions();

      if (availableSizes[size] <= 0) {
        sizeSelect.value = "";
        quantitySelect.innerHTML = '<option value="">Select size first</option>';
        quantitySelect.disabled = true;
      } else {
        sizeSelect.dispatchEvent(new Event("change"));
      }
    }
  </script>

  <script>
    // === Fullscreen Image Viewer Logic ===
    const modal = document.getElementById('fullscreenModal');
    const modalImg = document.getElementById('fullscreenImage');
    const closeBtn = modal.querySelector('.close-btn');

    // Prevent arrow buttons from triggering popup
    const arrowButtons = document.querySelectorAll('.image-nav button');

    // Add click listeners to images
    images.forEach(img => {
      img.addEventListener('click', (e) => {
        if (!Array.from(arrowButtons).includes(e.target)) {
          modal.style.display = 'flex';
          modalImg.src = img.src;
          modalImg.alt = img.alt;
        }
      });
    });

    // Close on X button click
    closeBtn.addEventListener('click', () => {
      modal.style.display = 'none';
      modalImg.src = '';
    });

    // Optional: click anywhere outside image to close
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.style.display = 'none';
        modalImg.src = '';
      }
    });
  </script>

</body>
</html>
